#ifndef SNOW_WHITE_H_INCLUDED
#define SNOW_WHITE_H_INCLUDED

// 包含基礎定義檔，提供 Card、Deck、Fable、Player 等結構體定義
#include "base.h"
// 包含共用卡牌定義，提供基礎攻擊、防禦、移動卡牌的聲明
#include "cards.h"

// =============================================================================
// 函數聲明區域
// =============================================================================

/**
 * 初始化白雪公主角色的設置函數
 * 這個函數會設置玩家的角色為白雪公主，建立起始牌組，並進行初始化
 * 
 * @param p 指向要設置的玩家結構體的指標
 */
void setup_snow_white(Player *p);

/**
 * 白雪公主的卡牌效果處理函數
 * 所有白雪公主的技能卡都會呼叫這個函數來執行特殊效果
 * 
 * @param self 使用卡牌的玩家（白雪公主）
 * @param target 目標玩家（通常是對手）
 */
void snow_white_effect(void *self, void *target);

/**
 * 初始化中毒牌庫的函數
 * 設置遊戲開始時的中毒牌庫，包含各等級的中毒牌
 */
void init_poison_deck(void);

/**
 * 從中毒牌庫取得指定等級的中毒牌
 * 
 * @param level 中毒牌等級（1-3）
 * @return 指向中毒牌的指標，如果沒有可用的牌則返回 NULL
 */
Card* get_poison_card(int level);

/**
 * 計算對手棄牌堆中中毒牌的數量
 * 用於七蛇之怒必殺技的傷害計算
 * 
 * @param player 要檢查的玩家
 * @return 棄牌堆中中毒牌的總數量
 */
int count_poison_in_discard(Player *player);

// =============================================================================
// 角色聲明區域
// =============================================================================

/**
 * 白雪公主角色定義
 * 包含角色的基本屬性：生命值、防禦上限、必殺閾值等
 */
extern Fable snow_white;

// =============================================================================
// 中毒牌庫系統
// =============================================================================

/**
 * 各等級中毒牌的定義
 * 這些是白雪公主獨有的特殊牌型，會被放入對手的牌組中
 */
extern Card poison1;        // 1級中毒牌
extern Card poison2;        // 2級中毒牌  
extern Card poison3;        // 3級中毒牌

/**
 * 中毒牌庫
 * 存放所有可用的中毒牌，是白雪公主機制的核心資源
 */
extern Deck poison_deck;

// =============================================================================
// 攻擊技能卡聲明區域
// =============================================================================

/**
 * 等級一攻擊技能：水晶碎片
 * 射程1 傷害1+O，將對手牌庫頂1張牌棄入棄牌堆
 */
extern Card crystal_fragment;

/**
 * 等級二攻擊技能：水晶漩渦  
 * 射程1 傷害2+O，將對手牌庫頂2張牌棄入棄牌堆
 */
extern Card crystal_vortex;

/**
 * 等級三攻擊技能：水晶風暴
 * 射程1 傷害3+O，將對手牌庫頂3張牌棄入棄牌堆
 */
extern Card crystal_storm;

// =============================================================================
// 攻擊系統蛻變牌
// =============================================================================

/**
 * 蛻變1：水晶之棺
 * 當你透過攻擊行動或攻擊技能對對手造成至少兩點傷害時，
 * 將中毒牌庫頂部1張牌放入他的棄牌堆
 */
extern Card crystal_coffin;

/**
 * 蛻變2：至純之毒
 * 當一張中毒牌進入對手的棄牌堆時，他額外失去1點生命
 * 此蛻變牌可以累積
 */
extern Card pure_poison;

// =============================================================================
// 防禦技能卡聲明區域
// =============================================================================

/**
 * 等級一防禦技能：玷污的恩惠
 * 射程1 傷害1，將中毒牌庫頂部至多O張牌放入對手的棄牌堆中
 */
extern Card tainted_blessing;

/**
 * 等級二防禦技能：玷污的盛筵
 * 射程1 傷害2，將中毒牌庫頂部至多O張牌放入對手的棄牌堆中
 */
extern Card tainted_feast;

/**
 * 等級三防禦技能：玷污的狂歡
 * 射程1 傷害3，將中毒牌庫頂部至多O張牌放入對手的棄牌堆中
 */
extern Card tainted_carnival;

// =============================================================================
// 防禦系統蛻變牌
// =============================================================================

/**
 * 蛻變1：墮落之劫
 * 當你要透過一個防禦技能將中毒牌放入對手的棄牌堆時，
 * 可以選擇將其中1張中毒牌洗入他的牌庫來代替放入棄牌堆
 */
extern Card fallen_calamity;

// =============================================================================
// 移動技能卡聲明區域
// =============================================================================

/**
 * 等級一移動技能：破碎的幻想
 * 射程O 傷害1，將你放置到與對手相鄰的格子
 */
extern Card broken_fantasy;

/**
 * 等級二移動技能：破碎的現實
 * 射程1+O 傷害2，將你放置到與對手相鄰的格子
 */
extern Card broken_reality;

/**
 * 等級三移動技能：破碎的命運
 * 射程2+O 傷害3，將你放置到與對手相鄰的格子
 */
extern Card broken_destiny;

// =============================================================================
// 移動系統蛻變牌
// =============================================================================

/**
 * 蛻變1：劇毒之蝕
 * 當你透過一個移動行動穿過對手時，或是對手透過一個移動行動穿過你時，
 * 可以將中毒牌庫頂部一張牌放入他的棄牌堆
 */
extern Card toxic_erosion;

// =============================================================================
// 必殺技聲明區域
// =============================================================================

/**
 * 必殺技：七蛇之怒
 * 射程1 對手失去X點生命，X等於他棄牌堆中中毒牌的數量
 */
extern Card seven_serpent_rage;

/**
 * 必殺技：魔鏡之雨
 * 射程1 傷害3，對手必須棄掉他的全部手牌之後抽取4張牌
 */
extern Card mirror_rain;

/**
 * 必殺技：醞釀之災
 * 射程3 傷害3，你可以選擇將對手棄牌堆中至多3張牌洗入他的牌庫
 */
extern Card brewing_disaster;

// =============================================================================
// 注意：基礎卡牌（Attack1, Defense1, Move1 等）的聲明
// 已經包含在 cards.h 中，因此這裡不需要重複聲明
// 這遵循了模組化設計的 DRY（Don't Repeat Yourself）原則
// =============================================================================

#endif // SNOW_WHITE_H_INCLUDED